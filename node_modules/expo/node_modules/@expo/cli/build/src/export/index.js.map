{"version":3,"sources":["../../../src/export/index.ts"],"sourcesContent":["#!/usr/bin/env node\nimport arg from 'arg';\nimport chalk from 'chalk';\nimport path from 'path';\n\nimport { Command } from '../../bin/cli';\nimport { assertWithOptionsArgs, printHelp } from '../utils/args';\nimport { logCmdError } from '../utils/errors';\n\nexport const expoExport: Command = async (argv) => {\n  const rawArgsMap: arg.Spec = {\n    // Types\n    '--help': Boolean,\n    '--clear': Boolean,\n    '--dump-assetmap': Boolean,\n    '--dev': Boolean,\n    '--max-workers': Number,\n    '--output-dir': String,\n    '--platform': [String],\n    '--no-minify': Boolean,\n    '--no-bytecode': Boolean,\n    '--no-ssg': Boolean,\n    '--api-only': Boolean,\n    '--unstable-hosted-native': Boolean,\n\n    // Hack: This is added because EAS CLI always includes the flag.\n    // If supplied, we'll do nothing with the value, but at least the process won't crash.\n    // Note that we also don't show this value in the `--help` prompt since we don't want people to use it.\n    '--experimental-bundle': Boolean,\n\n    // Aliases\n    '-h': '--help',\n    // '-d': '--dump-assetmap',\n    '-c': '--clear',\n    '-p': '--platform',\n    // Interop with Metro docs and RedBox errors.\n    '--reset-cache': '--clear',\n  };\n\n  const args = assertWithOptionsArgs(rawArgsMap, {\n    argv,\n    permissive: true,\n  });\n\n  if (args['--help']) {\n    printHelp(\n      `Export the static files of the app for hosting it on a web server`,\n      chalk`npx expo export {dim <dir>}`,\n      [\n        chalk`<dir>                      Directory of the Expo project. {dim Default: Current working directory}`,\n        chalk`--output-dir <dir>         The directory to export the static files to. {dim Default: dist}`,\n        `--dev                      Configure static files for developing locally using a non-https server`,\n        `--no-minify                Prevent minifying source`,\n        `--no-bytecode              Prevent generating Hermes bytecode`,\n        `--max-workers <number>     Maximum number of tasks to allow the bundler to spawn`,\n        `--dump-assetmap            Emit an asset map for further processing`,\n        `--no-ssg, --api-only       Skip exporting static HTML files and only export API routes for web`,\n        chalk`-p, --platform <platform>  Options: android, ios, web, all. {dim Default: all}`,\n        chalk`-s, --source-maps [mode]   Emit JavaScript source maps. {dim Options: true, false, inline, external. Default: false}`,\n        `-c, --clear                Clear the bundler cache`,\n        `-h, --help                 Usage info`,\n      ].join('\\n')\n    );\n  }\n\n  // Handle --source-maps which can be a string or boolean (e.g., --source-maps or --source-maps inline)\n  const { resolveStringOrBooleanArgsAsync } = await import('../utils/resolveArgs.js');\n  const parsed = await resolveStringOrBooleanArgsAsync(argv ?? [], rawArgsMap, {\n    // Restrict to 'true', 'false', 'inline', 'external'. Other values are treated as project root.\n    '--source-maps': [Boolean, 'inline', 'external'],\n    '-s': '--source-maps',\n    // Deprecated\n    '--dump-sourcemap': '--source-maps',\n  }).catch(logCmdError);\n\n  const projectRoot = path.resolve(parsed.projectRoot);\n  const { resolveOptionsAsync } = await import('./resolveOptions.js');\n  const options = await resolveOptionsAsync(projectRoot, {\n    ...args,\n    '--source-maps': parsed.args['--source-maps'],\n  }).catch(logCmdError);\n\n  const { exportAsync } = await import('./exportAsync.js');\n  return exportAsync(projectRoot, options).catch(logCmdError);\n};\n"],"names":["expoExport","argv","rawArgsMap","Boolean","Number","String","args","assertWithOptionsArgs","permissive","printHelp","chalk","join","resolveStringOrBooleanArgsAsync","parsed","catch","logCmdError","projectRoot","path","resolve","resolveOptionsAsync","options","exportAsync"],"mappings":";;;;;+BASaA;;;eAAAA;;;;gEAPK;;;;;;;gEACD;;;;;;sBAGgC;wBACrB;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAErB,MAAMA,aAAsB,OAAOC;IACxC,MAAMC,aAAuB;QAC3B,QAAQ;QACR,UAAUC;QACV,WAAWA;QACX,mBAAmBA;QACnB,SAASA;QACT,iBAAiBC;QACjB,gBAAgBC;QAChB,cAAc;YAACA;SAAO;QACtB,eAAeF;QACf,iBAAiBA;QACjB,YAAYA;QACZ,cAAcA;QACd,4BAA4BA;QAE5B,gEAAgE;QAChE,sFAAsF;QACtF,uGAAuG;QACvG,yBAAyBA;QAEzB,UAAU;QACV,MAAM;QACN,2BAA2B;QAC3B,MAAM;QACN,MAAM;QACN,6CAA6C;QAC7C,iBAAiB;IACnB;IAEA,MAAMG,OAAOC,IAAAA,2BAAqB,EAACL,YAAY;QAC7CD;QACAO,YAAY;IACd;IAEA,IAAIF,IAAI,CAAC,SAAS,EAAE;QAClBG,IAAAA,eAAS,EACP,CAAC,iEAAiE,CAAC,EACnEC,IAAAA,gBAAK,CAAA,CAAC,2BAA2B,CAAC,EAClC;YACEA,IAAAA,gBAAK,CAAA,CAAC,kGAAkG,CAAC;YACzGA,IAAAA,gBAAK,CAAA,CAAC,2FAA2F,CAAC;YAClG,CAAC,iGAAiG,CAAC;YACnG,CAAC,mDAAmD,CAAC;YACrD,CAAC,6DAA6D,CAAC;YAC/D,CAAC,gFAAgF,CAAC;YAClF,CAAC,mEAAmE,CAAC;YACrE,CAAC,8FAA8F,CAAC;YAChGA,IAAAA,gBAAK,CAAA,CAAC,8EAA8E,CAAC;YACrFA,IAAAA,gBAAK,CAAA,CAAC,oHAAoH,CAAC;YAC3H,CAAC,kDAAkD,CAAC;YACpD,CAAC,qCAAqC,CAAC;SACxC,CAACC,IAAI,CAAC;IAEX;IAEA,sGAAsG;IACtG,MAAM,EAAEC,+BAA+B,EAAE,GAAG,MAAM,mEAAA,QAAO;IACzD,MAAMC,SAAS,MAAMD,gCAAgCX,QAAQ,EAAE,EAAEC,YAAY;QAC3E,+FAA+F;QAC/F,iBAAiB;YAACC;YAAS;YAAU;SAAW;QAChD,MAAM;QACN,aAAa;QACb,oBAAoB;IACtB,GAAGW,KAAK,CAACC,mBAAW;IAEpB,MAAMC,cAAcC,eAAI,CAACC,OAAO,CAACL,OAAOG,WAAW;IACnD,MAAM,EAAEG,mBAAmB,EAAE,GAAG,MAAM,mEAAA,QAAO;IAC7C,MAAMC,UAAU,MAAMD,oBAAoBH,aAAa;QACrD,GAAGV,IAAI;QACP,iBAAiBO,OAAOP,IAAI,CAAC,gBAAgB;IAC/C,GAAGQ,KAAK,CAACC,mBAAW;IAEpB,MAAM,EAAEM,WAAW,EAAE,GAAG,MAAM,mEAAA,QAAO;IACrC,OAAOA,YAAYL,aAAaI,SAASN,KAAK,CAACC,mBAAW;AAC5D"}