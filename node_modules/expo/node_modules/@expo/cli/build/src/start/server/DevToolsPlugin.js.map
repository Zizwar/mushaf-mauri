{"version":3,"sources":["../../../../src/start/server/DevToolsPlugin.ts"],"sourcesContent":["import { DevToolsPluginInfo, PluginSchema } from './DevToolsPlugin.schema';\nimport { DevToolsPluginCliExtensionExecutor } from './DevToolsPluginCliExtensionExecutor';\nimport { DevToolsPluginEndpoint } from './DevToolsPluginManager';\nimport { Log } from '../../log';\n\n/**\n * Class that represents a DevTools plugin with CLI and/or web extensions\n *\n * Responsibilities:\n * - Validates plugin configuration against schema\n * - Provides access to plugin metadata (name, description\n * , endpoints)\n * - Manages CLI command execution via DevToolsPluginExecutor\n * - Lazily initializes executor when needed\n * - Constructs web endpoint URLs based on server configuration\n */\nexport class DevToolsPlugin {\n  constructor(\n    private plugin: DevToolsPluginInfo,\n    public readonly projectRoot: string\n  ) {\n    // Validate configuration schema\n    const result = PluginSchema.safeParse(plugin);\n    if (!result.success) {\n      throw new Error(`Invalid plugin configuration: ${result.error.message}`, {\n        cause: result.error,\n      });\n    }\n  }\n\n  private _executor: DevToolsPluginCliExtensionExecutor | undefined = undefined;\n\n  get packageName(): string {\n    return this.plugin.packageName;\n  }\n\n  get packageRoot(): string {\n    return this.plugin.packageRoot;\n  }\n\n  get webpageEndpoint(): string | undefined {\n    return this.plugin?.webpageRoot\n      ? `${DevToolsPluginEndpoint}/${this.plugin?.packageName}`\n      : undefined;\n  }\n\n  get webpageRoot(): string | undefined {\n    return this.plugin?.webpageRoot;\n  }\n\n  get description(): string {\n    return this.plugin.cliExtensions?.description ?? '';\n  }\n\n  get cliExtensions(): DevToolsPluginInfo['cliExtensions'] {\n    return this.plugin.cliExtensions;\n  }\n\n  get executor(): DevToolsPluginCliExtensionExecutor | undefined {\n    if (!this.plugin.cliExtensions?.entryPoint) {\n      return undefined;\n    }\n\n    if (!this._executor) {\n      this._executor = new DevToolsPluginCliExtensionExecutor(this.plugin, this.projectRoot);\n    }\n\n    return this._executor;\n  }\n}\n"],"names":["DevToolsPlugin","constructor","plugin","projectRoot","_executor","undefined","result","PluginSchema","safeParse","success","Error","error","message","cause","packageName","packageRoot","webpageEndpoint","webpageRoot","DevToolsPluginEndpoint","description","cliExtensions","executor","entryPoint","DevToolsPluginCliExtensionExecutor"],"mappings":";;;;+BAgBaA;;;eAAAA;;;sCAhBoC;oDACE;uCACZ;AAchC,MAAMA;IACXC,YACE,AAAQC,MAA0B,EAClC,AAAgBC,WAAmB,CACnC;aAFQD,SAAAA;aACQC,cAAAA;aAWVC,YAA4DC;QATlE,gCAAgC;QAChC,MAAMC,SAASC,kCAAY,CAACC,SAAS,CAACN;QACtC,IAAI,CAACI,OAAOG,OAAO,EAAE;YACnB,MAAM,IAAIC,MAAM,CAAC,8BAA8B,EAAEJ,OAAOK,KAAK,CAACC,OAAO,EAAE,EAAE;gBACvEC,OAAOP,OAAOK,KAAK;YACrB;QACF;IACF;IAIA,IAAIG,cAAsB;QACxB,OAAO,IAAI,CAACZ,MAAM,CAACY,WAAW;IAChC;IAEA,IAAIC,cAAsB;QACxB,OAAO,IAAI,CAACb,MAAM,CAACa,WAAW;IAChC;IAEA,IAAIC,kBAAsC;YACjC,cAC0B;QADjC,OAAO,EAAA,eAAA,IAAI,CAACd,MAAM,qBAAX,aAAae,WAAW,IAC3B,GAAGC,6CAAsB,CAAC,CAAC,GAAE,gBAAA,IAAI,CAAChB,MAAM,qBAAX,cAAaY,WAAW,EAAE,GACvDT;IACN;IAEA,IAAIY,cAAkC;YAC7B;QAAP,QAAO,eAAA,IAAI,CAACf,MAAM,qBAAX,aAAae,WAAW;IACjC;IAEA,IAAIE,cAAsB;YACjB;QAAP,OAAO,EAAA,6BAAA,IAAI,CAACjB,MAAM,CAACkB,aAAa,qBAAzB,2BAA2BD,WAAW,KAAI;IACnD;IAEA,IAAIC,gBAAqD;QACvD,OAAO,IAAI,CAAClB,MAAM,CAACkB,aAAa;IAClC;IAEA,IAAIC,WAA2D;YACxD;QAAL,IAAI,GAAC,6BAAA,IAAI,CAACnB,MAAM,CAACkB,aAAa,qBAAzB,2BAA2BE,UAAU,GAAE;YAC1C,OAAOjB;QACT;QAEA,IAAI,CAAC,IAAI,CAACD,SAAS,EAAE;YACnB,IAAI,CAACA,SAAS,GAAG,IAAImB,sEAAkC,CAAC,IAAI,CAACrB,MAAM,EAAE,IAAI,CAACC,WAAW;QACvF;QAEA,OAAO,IAAI,CAACC,SAAS;IACvB;AACF"}